Process 17597: Initializing TITAN model...

===== FOLD 1/5 =====
/home/aletolia/anaconda3/envs/fate/lib/python3.10/site-packages/torch/optim/lr_scheduler.py:28: UserWarning: The verbose parameter is deprecated. Please use get_last_lr() to access the learning rate.
  warnings.warn("The verbose parameter is deprecated. Please use get_last_lr() "
--- Epoch 1/30 ---
Traceback (most recent call last):                                                                                                                                                                                                                                                                        
  File "/home/aletolia/documents/CPath/Fate/main.py", line 200, in <module>
    main()
  File "/home/aletolia/documents/CPath/Fate/main.py", line 191, in main
    cross_validation_loop(
  File "/home/aletolia/documents/CPath/Fate/main.py", line 86, in cross_validation_loop
    train_metrics, train_errors = run_epoch(model, train_loader, device, flags, optimizer, task_criteria, dwa_keeper)
  File "/home/aletolia/documents/CPath/Fate/trainer.py", line 46, in run_epoch
    model_output = model(
  File "/home/aletolia/anaconda3/envs/fate/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/aletolia/anaconda3/envs/fate/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/aletolia/documents/CPath/Fate/model.py", line 134, in forward
    shared_fused_feature = self.shared_fusion_module(
  File "/home/aletolia/anaconda3/envs/fate/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/aletolia/anaconda3/envs/fate/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/aletolia/documents/CPath/Fate/utils.py", line 307, in forward
    fused_output = self.fusion_layers[i]['cross_attn'](
  File "/home/aletolia/anaconda3/envs/fate/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/aletolia/anaconda3/envs/fate/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/aletolia/documents/CPath/Fate/utils.py", line 249, in forward
    attn_output = multi_head_attention_forward(
  File "/home/aletolia/documents/CPath/Fate/utils.py", line 201, in multi_head_attention_forward
    v = v_proj(value)
  File "/home/aletolia/anaconda3/envs/fate/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/aletolia/anaconda3/envs/fate/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/aletolia/anaconda3/envs/fate/lib/python3.10/site-packages/torch/nn/modules/linear.py", line 116, in forward
    return F.linear(input, self.weight, self.bias)
KeyboardInterrupt
Traceback (most recent call last):
  File "/home/aletolia/documents/CPath/Fate/main.py", line 200, in <module>
    main()
  File "/home/aletolia/documents/CPath/Fate/main.py", line 191, in main
    cross_validation_loop(
  File "/home/aletolia/documents/CPath/Fate/main.py", line 86, in cross_validation_loop
    train_metrics, train_errors = run_epoch(model, train_loader, device, flags, optimizer, task_criteria, dwa_keeper)
  File "/home/aletolia/documents/CPath/Fate/trainer.py", line 46, in run_epoch
    model_output = model(
  File "/home/aletolia/anaconda3/envs/fate/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/aletolia/anaconda3/envs/fate/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/aletolia/documents/CPath/Fate/model.py", line 134, in forward
    shared_fused_feature = self.shared_fusion_module(
  File "/home/aletolia/anaconda3/envs/fate/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/aletolia/anaconda3/envs/fate/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/aletolia/documents/CPath/Fate/utils.py", line 307, in forward
    fused_output = self.fusion_layers[i]['cross_attn'](
  File "/home/aletolia/anaconda3/envs/fate/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/aletolia/anaconda3/envs/fate/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/aletolia/documents/CPath/Fate/utils.py", line 249, in forward
    attn_output = multi_head_attention_forward(
  File "/home/aletolia/documents/CPath/Fate/utils.py", line 201, in multi_head_attention_forward
    v = v_proj(value)
  File "/home/aletolia/anaconda3/envs/fate/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/aletolia/anaconda3/envs/fate/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/aletolia/anaconda3/envs/fate/lib/python3.10/site-packages/torch/nn/modules/linear.py", line 116, in forward
    return F.linear(input, self.weight, self.bias)
KeyboardInterrupt
